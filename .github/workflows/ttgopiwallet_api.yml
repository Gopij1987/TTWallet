name: TTGopiWallet API Automation

on:
  schedule:
    - cron: '02 0 * * 1-6'  # Runs at 5:32 AM IST (0:32 UTC)
  workflow_dispatch:

jobs:
  run-api-automation:
    runs-on: ubuntu-latest
    env:
      TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      TT_COOKIES_B64_GOPI: ${{ secrets.TT_COOKIES_B64_GOPI }}
      NUM_TOGGLES_GOPI: ${{ secrets.NUM_TOGGLES_GOPI }}
      STRATEGY_ID_GOPI: ${{ secrets.STRATEGY_ID_GOPI }}
      DELAY_SECONDS: ${{ secrets.DELAY_SECONDS }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - name: Install dependencies
        run: |
          cd TTGopiWallet
          pip install -r requirements.txt
      - name: Run API automation script
        run: |
          cd TTGopiWallet
          python api_automation_TTGopiWallet.py
